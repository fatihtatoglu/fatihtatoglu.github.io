<!DOCTYPE html><html lang="en"><head><base href="https://blog.tatoglu.net/"><meta charset="UTF-8"><meta name="yandex-verification" content="31a29a16b97b37a8"><meta name="msvalidate.01" content="578B5091D7C5A2C03BE2EE0DF0CCC024"><meta name="google-site-verification" content="Ovuv1WWfkBGnFfpFHwwPPQSv274GrePTq1hq1Oq0Xc8"><link rel="profile" href="https://gmpg.org/xfn/11"><meta name="description" content="Preparing a software development environment with Fatih's habits and preferences."><meta name="author" content="Fatih Tatoğlu"><meta name="robots" content="all, max-image-preview:large, max-snippet:-1, max-video-preview:-1"><link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link href="https://fonts.googleapis.com/css2?family=Outfit:wght@400;700&display=swap&v=77cffab9fa8bd66e459b49279028171c" rel="stylesheet"><link rel="canonical" href="https://blog.tatoglu.net/en/lab/environment/hyperv.html"><link rel="alternate" hreflang="x-default" href="https://blog.tatoglu.net/lab/environment/hyperv.html"><link rel="alternate" hreflang="tr" href="https://blog.tatoglu.net/lab/environment/hyperv.html"><link rel="alternate" hreflang="en" href="https://blog.tatoglu.net/en/lab/environment/hyperv.html"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Fatih Tatoğlu - Creating Virtual Machine with Hyper-V</title><link rel="stylesheet" href="https://blog.tatoglu.net/css/main.css?v=77cffab9fa8bd66e459b49279028171c"><link rel="stylesheet" href="https://blog.tatoglu.net/css/custom.css?v=77cffab9fa8bd66e459b49279028171c"><link rel="apple-touch-icon" sizes="180x180" href="https://blog.tatoglu.net/image/favicon/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="https://blog.tatoglu.net/image/favicon/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="https://blog.tatoglu.net/image/favicon/favicon-16x16.png"><link rel="manifest" href="https://blog.tatoglu.net/image/favicon/site.webmanifest"><link rel="icon" href="https://blog.tatoglu.net/favicon.ico" type="image/x-icon"><link rel="shortcut icon" href="https://blog.tatoglu.net/favicon.ico" type="image/x-icon"><meta name="twitter:card" content="summary"><meta name="twitter:site" content="@fatihtatoglu"><meta name="twitter:title" content="Creating Virtual Machine with Hyper-V"><meta name="twitter:description" content="Preparing a software development environment with Fatih's habits and preferences."><script type="application/ld+json">{"@context": "https://schema.org","@graph": [{"@type": "WebSite","@id": "https://blog.tatoglu.net/#website","url": "https://blog.tatoglu.net/","name": "Fatih Tatoğlu","description": "Fatih Tatoğlu - Kişisel Web Sayfası","publisher": {"@id": "https://blog.tatoglu.net//#/schema/person/9112274035621a3fbf80e30c19216034"},"inLanguage": ""},{"@type": "WebPage","@id": "https://blog.tatoglu.net/en/lab/environment/hyperv.html/#webpage","url": "https://blog.tatoglu.net/en/lab/environment/hyperv.html","name": "Creating Virtual Machine with Hyper-V - Fatih Tatoğlu","isPartOf": {"@id": "https://blog.tatoglu.net/#website"},"datePublished": "2023-10-27T21:37:00+0000","breadcrumb": {"@id": "https://blog.tatoglu.net/en/lab/environment/hyperv.html/#breadcrumb"},"inLanguage": "","potentialAction": [{"@type": "ReadAction","target": ["https://blog.tatoglu.net/en/lab/environment/hyperv.html"]}]},{"@type": "BreadcrumbList","@id": "https://blog.tatoglu.net/en/lab/environment/hyperv.html/#breadcrumb","itemListElement": [{"@type": "ListItem","position": 1,"name": "Ana sayfa","item": "https://blog.tatoglu.net/"},{"@type": "ListItem","position": 2,"name": "Creating Virtual Machine with Hyper-V"}]},{"@type": "Article","@id": "https://blog.tatoglu.net/en/lab/environment/hyperv.html/#article","isPartOf": {"@id": "https://blog.tatoglu.net/en/lab/environment/hyperv.html/#webpage"},"author": {"@id": "https://blog.tatoglu.net//#/schema/person/9112274035621a3fbf80e30c19216034"},"headline": "Creating Virtual Machine with Hyper-V","datePublished": "2023-10-27T21:37:00+0000","mainEntityOfPage": {"@id": "https://blog.tatoglu.net/en/lab/environment/hyperv.html/#webpage"},"publisher": {"@id": "https://blog.tatoglu.net//#/schema/person/9112274035621a3fbf80e30c19216034"},"articleSection": ["lab"],"keywords": ["powershell","hyper-v","virtual machine","virtual switch"],"inLanguage": ""},{"@type": ["Person"],"@id": "https://blog.tatoglu.net//#/schema/person/9112274035621a3fbf80e30c19216034","name": "Fatih Tatoğlu","url": "https://blog.tatoglu.net/about-me.html","image": {"@type": "ImageObject","@id": "https://blog.tatoglu.net/#personlogo","inLanguage": "","url": "https://blog.tatoglu.net/image/about_me.jpg","contentUrl": "https://blog.tatoglu.net/image/about_me.jpg","width": 1024,"height": 683,"caption": "Fatih Tatoğlu"},"address": {"@type": "PostalAddress","addressLocality": "İstanbul","addressCountry": "Turkey"},"email": "fatih@tatoglu.net"}]}</script></head><body><header><h1 id="title">Creating Virtual Machine with Hyper-V</h1><summary></summary></header><nav><i class="menu-icon">&#9776;</i><ul><li><a href="https://blog.tatoglu.net/en/index.html">Home Page</a></li><li><a href="https://blog.tatoglu.net/en/coaching/index.html">Coaching</a></li><li><a href="https://blog.tatoglu.net/en/my-notes/index.html">My Notes</a></li><li><a href="https://blog.tatoglu.net/en/lab/index.html">Laboratory</a></li><li><a href="https://blog.tatoglu.net/en/about-me.html">About Me</a></li><li><button id="btnFeedback" class="icon feedback" title="Feedback">&nbsp;</button> <button id="btnDarkTheme" class="icon dark-theme" title="Dark Theme">&nbsp;</button> <button id="btnLightTheme" class="icon light-theme" title="Light Theme">&nbsp;</button> <button id="btnTurkish" class="icon turkish" title="Turkish">&nbsp;</button></li></ul></nav><main class="labs"><section><strong>Building Development Environment</strong><ul><li><a href=".&#x2F;en&#x2F;lab&#x2F;environment&#x2F;setup.html">Host Setup</a></li><li class="active">Creating Virtual Machine with Hyper-V</li><li><a href=".&#x2F;en&#x2F;lab&#x2F;environment&#x2F;dev-setup-mint.html">Creating Development Environment with Linux Mint</a></li><li><a href=".&#x2F;en&#x2F;lab&#x2F;environment&#x2F;auto-update.html">Auto Updates</a></li></ul></section><article><p>After completing the preparation of the environment installation, I need a virtual machine to start development. I prefer to use Powershell instead of clicking many buttons.</p><h2>Network</h2><p>To reach the Internet or communicate with the host and other virtual machines, the network settings should be done first.</p><pre><code class="language-powershell"><span class="language-powershell-user">PS C:\Users\Fatih Tatoğlu&gt;</span> $natSwitch     = &quot;NATSwitch&quot;
<span class="language-powershell-user">PS C:\Users\Fatih Tatoğlu&gt;</span> $natIPAddress  = &quot;172.19.85.1&quot;
<span class="language-powershell-user">PS C:\Users\Fatih Tatoğlu&gt;</span> $natAddress    = &quot;172.19.85.0/24&quot;
<span class="language-powershell-user">PS C:\Users\Fatih Tatoğlu&gt;</span> 
<span class="language-powershell-user">PS C:\Users\Fatih Tatoğlu&gt;</span> New-VMSwitch -SwitchName $natSwitch -SwitchType Internal
<span class="language-powershell-user">PS C:\Users\Fatih Tatoğlu&gt;</span> New-NetIPAddress -IPAddress $natIPAddress -PrefixLength 24 -InterfaceAlias &quot;vEthernet ($natSwitch)&quot;
<span class="language-powershell-user">PS C:\Users\Fatih Tatoğlu&gt;</span> 
<span class="language-powershell-user">PS C:\Users\Fatih Tatoğlu&gt;</span> New-NetNAT -Name $natSwitch -InternalIPInterfaceAddressPrefix $natAddress
</code></pre><p>With the above commands, the virtual switch would be created. I selected the <code>172.19.85.0/24</code> IP range but it can be changed with wants and needs.</p><h2>Creating Virtual Machine</h2><pre><code class="language-powershell"><span class="language-powershell-user">PS C:\Users\Fatih Tatoğlu&gt;</span> $natSwitch = &quot;NATSwitch&quot;
<span class="language-powershell-user">PS C:\Users\Fatih Tatoğlu&gt;</span> $vmName = &quot;fth-dev&quot;
<span class="language-powershell-user">PS C:\Users\Fatih Tatoğlu&gt;</span> $workspacePath = &quot;C:\\workspace\\machine\\&quot;
<span class="language-powershell-user">PS C:\Users\Fatih Tatoğlu&gt;</span> 
<span class="language-powershell-user">PS C:\Users\Fatih Tatoğlu&gt;</span> $ramSize  = 8GB 
<span class="language-powershell-user">PS C:\Users\Fatih Tatoğlu&gt;</span> $diskSize = 50GB
<span class="language-powershell-user">PS C:\Users\Fatih Tatoğlu&gt;</span> 
<span class="language-powershell-user">PS C:\Users\Fatih Tatoğlu&gt;</span> New-VHD -Path &quot;$workspacePath\\$vmName\\$vmName.vhdx&quot; -SizeBytes $diskSize -Fixed -BlockSizeBytes 1MB
<span class="language-powershell-user">PS C:\Users\Fatih Tatoğlu&gt;</span> 
<span class="language-powershell-user">PS C:\Users\Fatih Tatoğlu&gt;</span> New-VM -Name $vmName -MemoryStartupBytes $ramSize -BootDevice VHD -VHDPath &quot;$workspacePath\\$vmName\\$vmName.vhdx&quot; -Path &quot;$workspacePath&quot; -Generation 2 -Switch $natSwitch
<span class="language-powershell-user">PS C:\Users\Fatih Tatoğlu&gt;</span> 
<span class="language-powershell-user">PS C:\Users\Fatih Tatoğlu&gt;</span> Set-VMFirmware $vmName -EnableSecureBoot Off
<span class="language-powershell-user">PS C:\Users\Fatih Tatoğlu&gt;</span> Set-VMProcessor -VMName $vmName -Count 2
<span class="language-powershell-user">PS C:\Users\Fatih Tatoğlu&gt;</span> Set-VM -Name $vmName -AutomaticCheckpointsEnabled $false -CheckpointType Disabled
<span class="language-powershell-user">PS C:\Users\Fatih Tatoğlu&gt;</span> Set-VMMemory -VMName $vmName -DynamicMemoryEnabled $true -MinimumBytes ($ramSize / 16) -StartupBytes ($ramSize / 8) -MaximumBytes $ramSize
<span class="language-powershell-user">PS C:\Users\Fatih Tatoğlu&gt;</span> 
<span class="language-powershell-user">PS C:\Users\Fatih Tatoğlu&gt;</span> Add-VMDvdDrive -VMName $vmName -Path &quot;C:\\workspace\\iso\\linuxmint-21.2-xfce-64bit.iso&quot;
<span class="language-powershell-user">PS C:\Users\Fatih Tatoğlu&gt;</span> 
<span class="language-powershell-user">PS C:\Users\Fatih Tatoğlu&gt;</span> $dvd = Get-VMDVDDrive -VMName $vmName
<span class="language-powershell-user">PS C:\Users\Fatih Tatoğlu&gt;</span> Set-VMFirmware -VMName $vmName -FirstBootDevice $dvd
<span class="language-powershell-user">PS C:\Users\Fatih Tatoğlu&gt;</span> Start-VM -Name $vmName
</code></pre><p>With the above commands, the virtual disk will be created. Then, the virtual machine will be arranged, and finally, the machine is started.</p><p>🔥 By changing the parameter, the different virtual machines can be created. On the other hand, those virtual machines are the base and empty machines. Don&#39;t forget to set its network settings manually.</p><p>If the below command is applied, the host machine will connect to the guest machine.</p><pre><code class="language-powershell"><span class="language-powershell-user">PS C:\Users\Fatih Tatoğlu&gt;</span> $computer = hostname
<span class="language-powershell-user">PS C:\Users\Fatih Tatoğlu&gt;</span> vmconnect.exe $computer $vmName
</code></pre><h2>Virtual Machine Setting</h2><p>I learned by experience with the different scenarios the network setting of the virtual machine may be tricky. In my environment, the DNS must be assigned the same as the host&#39;s gateway IP address. For example, if the host&#39;s gateway IP address is <code>192.168.6.1</code>. The virtual machine&#39;s DNS IP address must be <code>192.168.6.1</code>. The DNS server IP addresses can be used if a valid DNS server has been located.</p></article></main><footer>&copy; 1985 - <a href="en/about-me.html" rel="noopener noreferrer" target="_blank">Fatih Tatoğlu</a></footer><script src="https://blog.tatoglu.net/js/main.js?v=77cffab9fa8bd66e459b49279028171c"></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-GSVKFRLFNV&v=77cffab9fa8bd66e459b49279028171c"></script><script src="https://blog.tatoglu.net/js/analytics.js?v=77cffab9fa8bd66e459b49279028171c"></script><div id="pnlFeedbackSurvey"><div class="model-content"><button id="btnFeedbackSurveyClose" class="icon bold x-small">&times;</button><iframe src="https://docs.google.com/forms/d/e/1FAIpQLSewJ_x10HBlFs2lO2zHUBI3ZeSdEXaISpK292RPJBoZyeC1HA/viewform?embedded=true" frameborder="0" marginheight="0" marginwidth="0">Loading…</iframe></div></div></body></html>