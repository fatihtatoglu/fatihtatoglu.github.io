<!DOCTYPE html><html lang="tr"><head><base href="https://blog.tatoglu.net/"><meta charset="UTF-8"><meta name="yandex-verification" content="31a29a16b97b37a8"><meta name="msvalidate.01" content="578B5091D7C5A2C03BE2EE0DF0CCC024"><meta name="google-site-verification" content="Ovuv1WWfkBGnFfpFHwwPPQSv274GrePTq1hq1Oq0Xc8"><link rel="profile" href="https://gmpg.org/xfn/11"><meta name="description" content="HAProxy yönlendirmeyi kurallara göre yapmaktadır. Ancak bazen kurallara uymayan isteklerde geldiğinde bunların da cevaplanması gerekmektedir."><meta name="author" content="Fatih Tatoğlu"><meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1"><link rel="canonical" href="https://blog.tatoglu.net/kendime-notlar/lab/haproxy/varsayilan-yonlendirme.html"><link rel="alternate" hreflang="x-default" href="https://blog.tatoglu.net/kendime-notlar/lab/haproxy/varsayilan-yonlendirme.html"><link rel="alternate" hreflang="tr" href="https://blog.tatoglu.net/kendime-notlar/lab/haproxy/varsayilan-yonlendirme.html"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Fatih Tatoğlu - HAProxy - Varsayılan Yönlendirme</title><link rel="stylesheet" href="https://blog.tatoglu.net/css/main.css?v=88ccce3f894b722b90a830e7fe36ab5c"><link rel="stylesheet" href="https://blog.tatoglu.net/css/custom.css?v=88ccce3f894b722b90a830e7fe36ab5c"><link rel="stylesheet" href="https://blog.tatoglu.net/css/3024.css?v=88ccce3f894b722b90a830e7fe36ab5c"><script src="https://blog.tatoglu.net/js/main.js?v=88ccce3f894b722b90a830e7fe36ab5c"></script><script src="https://blog.tatoglu.net/js/analytics.js?v=88ccce3f894b722b90a830e7fe36ab5c"></script><link rel="apple-touch-icon" sizes="180x180" href="https://blog.tatoglu.net/image/favicon/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="https://blog.tatoglu.net/image/favicon/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="https://blog.tatoglu.net/image/favicon/favicon-16x16.png"><link rel="manifest" href="https://blog.tatoglu.net/image/favicon/site.webmanifest"><link rel="icon" href="https://blog.tatoglu.net/favicon.ico" type="image/x-icon"><link rel="shortcut icon" href="https://blog.tatoglu.net/favicon.ico" type="image/x-icon"><meta name="twitter:card" content="summary"><meta name="twitter:site" content="@fatihtatoglu"><meta name="twitter:title" content="HAProxy - Varsayılan Yönlendirme"><meta name="twitter:description" content="HAProxy yönlendirmeyi kurallara göre yapmaktadır. Ancak bazen kurallara uymayan isteklerde geldiğinde bunların da cevaplanması gerekmektedir."><script type="application/ld+json">{"@context": "https://schema.org","@graph": [{"@type": "WebSite","@id": "https://blog.tatoglu.net/#website","url": "https://blog.tatoglu.net/","name": "Fatih Tatoğlu","description": "Fatih Tatoğlu - Kişisel Web Sayfası","publisher": {"@id": "https://blog.tatoglu.net//#/schema/person/9112274035621a3fbf80e30c19216034"},"inLanguage": ""},{"@type": "WebPage","@id": "https://blog.tatoglu.net/kendime-notlar/lab/haproxy/varsayilan-yonlendirme.html/#webpage","url": "https://blog.tatoglu.net/kendime-notlar/lab/haproxy/varsayilan-yonlendirme.html","name": "HAProxy - Varsayılan Yönlendirme - Fatih Tatoğlu","isPartOf": {"@id": "https://blog.tatoglu.net/#website"},"datePublished": "2022-06-12T20:25:53+0000","breadcrumb": {"@id": "https://blog.tatoglu.net/kendime-notlar/lab/haproxy/varsayilan-yonlendirme.html/#breadcrumb"},"inLanguage": "","potentialAction": [{"@type": "ReadAction","target": ["https://blog.tatoglu.net/kendime-notlar/lab/haproxy/varsayilan-yonlendirme.html"]}]},{"@type": "BreadcrumbList","@id": "https://blog.tatoglu.net/kendime-notlar/lab/haproxy/varsayilan-yonlendirme.html/#breadcrumb","itemListElement": [{"@type": "ListItem","position": 1,"name": "Ana sayfa","item": "https://blog.tatoglu.net/"},{"@type": "ListItem","position": 2,"name": "HAProxy - Varsayılan Yönlendirme"}]},{"@type": "Article","@id": "https://blog.tatoglu.net/kendime-notlar/lab/haproxy/varsayilan-yonlendirme.html/#article","isPartOf": {"@id": "https://blog.tatoglu.net/kendime-notlar/lab/haproxy/varsayilan-yonlendirme.html/#webpage"},"author": {"@id": "https://blog.tatoglu.net//#/schema/person/9112274035621a3fbf80e30c19216034"},"headline": "HAProxy - Varsayılan Yönlendirme","datePublished": "2022-06-12T20:25:53+0000","mainEntityOfPage": {"@id": "https://blog.tatoglu.net/kendime-notlar/lab/haproxy/varsayilan-yonlendirme.html/#webpage"},"publisher": {"@id": "https://blog.tatoglu.net//#/schema/person/9112274035621a3fbf80e30c19216034"},"keywords": ["haproxy","redirect","static content","statik icerik"],"inLanguage": ""},{"@type": ["Person"],"@id": "https://blog.tatoglu.net//#/schema/person/9112274035621a3fbf80e30c19216034","name": "Fatih Tatoğlu","url": "https://blog.tatoglu.net/about-me.html","image": {"@type": "ImageObject","@id": "https://blog.tatoglu.net/#personlogo","inLanguage": "","url": "https://blog.tatoglu.net/image/about_me.jpg","contentUrl": "https://blog.tatoglu.net/image/about_me.jpg","width": 1024,"height": 683,"caption": "Fatih Tatoğlu"},"address": {"@type": "PostalAddress","addressLocality": "İstanbul","addressCountry": "Turkey"},"email": "fatih@tatoglu.net"}]}</script></head><body><header><span class="site-name">Fatih Tatoğlu</span></header><nav id="navigation"><span class="menu-button">▼</span><ul><li><a href="javascript:;">-</a><div class="sub-menu"><ul><li><a id="btnSetting" href="javascript:;">Tema Ayarları</a></li></ul></div></li><li><a href="https://blog.tatoglu.net/index.html">Anasayfa</a></li><li><a href="https://blog.tatoglu.net/kocluk/index.html">Koçluk</a></li><li><a href="https://blog.tatoglu.net/projeler/index.html">Projeler</a></li><li><a href="https://blog.tatoglu.net/kendime-notlar/index.html">Kendime Notlar</a></li><li><a href="https://blog.tatoglu.net/hakkimda.html">Hakkımda</a></li></ul></nav><main><article data-clarity-region="article"><header><h1>HAProxy - Varsayılan Yönlendirme</h1><button>#</button></header><p>HAProxy gelen istekleri ayarlanan filtrelerden geçirerek ilgili <code>backend</code> servislerine yönlendirmektedir. Ancak eşleşme olmadığı zaman isteğin sonlanması için varsayılan bir cevap dönülmesi çok uygulanan bir yöntemdir. Bu yöntemi statik dosyalar için de kullanabiliriz. Özellikle arama motorlarının taramalarını bu şekilde sisteme yük getirmeden yapmasını sağlayabiliriz.</p><p>HAProxy konfigürasyon dosyasını aşağıdaki gibi güncelliyoruz.</p><pre><code class="hljs language-shell"><span class="hljs-meta prompt_">&gt; </span><span class="language-bash">sudo vi /etc/haproxy/haproxy.conf</span>
</code></pre><pre><code class="hljs language-nestedtext">...
<span class="hljs-comment">##################################################</span>
<span class="hljs-comment">#                    Frontend                    #</span>
<span class="hljs-comment">##################################################</span>
frontend http_in
    mode http
    bind *:80

    <span class="hljs-comment">#logging</span>
    option httplog

    <span class="hljs-comment">#http options</span>
    option http-server-close
    option forwardfor

    <span class="hljs-comment">#redirection rules</span>

    default_backend be_default
<span class="hljs-comment">##################################################</span>


<span class="hljs-comment">##################################################</span>
<span class="hljs-comment">#                    Backend                     #</span>
<span class="hljs-comment">##################################################</span>
backend be_default
    mode http

    errorfile 503 /etc/haproxy/errors/503.http
<span class="hljs-comment">##################################################</span>
...
</code></pre><p>Sonrasında statik içeriği oluşturuyoruz.</p><pre><code class="hljs language-shell"><span class="hljs-meta prompt_">&gt; </span><span class="language-bash">sudo vi /etc/haproxy/errors/503.http</span>
</code></pre><pre><code class="hljs language-html">HTTP/1.0 200 Found
Cache-Control: no-cache
Connection: close
Content-Type: text/html

<span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Fatih Tatoğlu<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>SERVICE UNAVAILABLE<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>The server is currently unable to handle the request due to a temporary overload or scheduled maintenance, which will likely be alleviated after some delay.<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre><p>Artık varsayılan cevabımız hazırdır. Konfigürasyon dosyasında 503 HTTP statü değerini verdiğimiz için istemciye 503 olarak dönülecektir.</p><p>Bu ayar uygulanmadan önce doğruluğu kontrol edilmeli ve sonrasında servisler güncellenerek yayına alınmalıdır.</p><p>Eğer cluster bir yapınız varsa iki makinede de aynı geliştirmenin yapılması gerekmektedir.</p><pre><code class="hljs language-shell"><span class="hljs-meta prompt_">&gt; </span><span class="language-bash">sudo /opt/haproxy/sbin/haproxy -c -V -f /etc/haproxy/haproxy.conf</span>
<span class="hljs-meta prompt_">&gt; </span><span class="language-bash">sudo systemctl reload haproxy</span>
</code></pre><footer>By <a href="about-me.html" rel="noopener noreferrer" target="_blank">Fatih Tatoğlu</a> - <time pubdate datetime="2022-06-12T20:25:53+0000" title="12.06.2022">12.06.2022</time></footer></article></main><footer><span class="credits">Fatih Tatoğlu &copy; 1985</span></footer><div id="pnlSettingDialog" class="dialog"><div class="dialog-box"><div class="dialog-content"><header><button>■</button><span>Tema Ayarları</span></header><main><table style="margin: auto;"><thead><th style="width: 150px;">Renkler</th></thead><tbody><tr><td style="text-align: left; padding-left: 5%;"><input id="rbColoraqua" name="color" type="radio" value="aqua"> <label for="rbColoraqua">Aqua</label><br><input id="rbColorblack" name="color" type="radio" value="black"> <label for="rbColorblack">Black</label><br><input id="rbColorblue" name="color" type="radio" value="blue"> <label for="rbColorblue">Blue</label><br><input id="rbColorwhite" name="color" type="radio" value="white"> <label for="rbColorwhite">White</label></td></tr></tbody></table><br></main><footer><button id="btnSettingDialogOK" class="default" accesskey="t"><u>T</u>amam</button></footer></div></div></div></body></html>