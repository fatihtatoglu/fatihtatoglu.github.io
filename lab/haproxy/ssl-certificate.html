<!DOCTYPE html><html lang="tr"><head><base href="https://blog.tatoglu.net/"><meta charset="UTF-8"><meta name="yandex-verification" content="31a29a16b97b37a8"><meta name="msvalidate.01" content="578B5091D7C5A2C03BE2EE0DF0CCC024"><meta name="google-site-verification" content="Ovuv1WWfkBGnFfpFHwwPPQSv274GrePTq1hq1Oq0Xc8"><link rel="profile" href="https://gmpg.org/xfn/11"><meta name="description" content="Verimli yÃ¼k dengeleme iÃ§in CentOS 7.X'te HAProxy'yi kurun. HazÄ±rlÄ±k, kurulum, yapÄ±landÄ±rma ve gÃ¼venlik iÃ§in adÄ±m adÄ±m talimatlarÄ± izleyin. Sorunsuz bir daÄŸÄ±tÄ±m saÄŸlayÄ±n."><meta name="author" content="Fatih TatoÄŸlu"><meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1"><link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link href="https://fonts.googleapis.com/css2?family=Outfit:wght@400;700&display=swap&v=96a6c3c79b3d35ef37896ed4f9a413ce" rel="stylesheet"><link rel="canonical" href="https://blog.tatoglu.net/lab/haproxy/ssl-certificate.html"><link rel="alternate" hreflang="x-default" href="https://blog.tatoglu.net/lab/haproxy/ssl-certificate.html"><link rel="alternate" hreflang="tr" href="https://blog.tatoglu.net/lab/haproxy/ssl-certificate.html"><link rel="alternate" hreflang="en" href="https://blog.tatoglu.net/en/lab/haproxy/ssl-certificate.html"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Fatih TatoÄŸlu - SSL Sertifika</title><link rel="stylesheet" href="https://blog.tatoglu.net/css/main.css?v=96a6c3c79b3d35ef37896ed4f9a413ce"><link rel="stylesheet" href="https://blog.tatoglu.net/css/custom.css?v=96a6c3c79b3d35ef37896ed4f9a413ce"><link rel="apple-touch-icon" sizes="180x180" href="https://blog.tatoglu.net/image/favicon/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="https://blog.tatoglu.net/image/favicon/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="https://blog.tatoglu.net/image/favicon/favicon-16x16.png"><link rel="manifest" href="https://blog.tatoglu.net/image/favicon/site.webmanifest"><link rel="icon" href="https://blog.tatoglu.net/favicon.ico" type="image/x-icon"><link rel="shortcut icon" href="https://blog.tatoglu.net/favicon.ico" type="image/x-icon"><meta name="twitter:card" content="summary"><meta name="twitter:site" content="@fatihtatoglu"><meta name="twitter:title" content="SSL Sertifika"><meta name="twitter:description" content="Verimli yÃ¼k dengeleme iÃ§in CentOS 7.X'te HAProxy'yi kurun. HazÄ±rlÄ±k, kurulum, yapÄ±landÄ±rma ve gÃ¼venlik iÃ§in adÄ±m adÄ±m talimatlarÄ± izleyin. Sorunsuz bir daÄŸÄ±tÄ±m saÄŸlayÄ±n."><script type="application/ld+json">{"@context": "https://schema.org","@graph": [{"@type": "WebSite","@id": "https://blog.tatoglu.net/#website","url": "https://blog.tatoglu.net/","name": "Fatih TatoÄŸlu","description": "Fatih TatoÄŸlu - KiÅŸisel Web SayfasÄ±","publisher": {"@id": "https://blog.tatoglu.net//#/schema/person/9112274035621a3fbf80e30c19216034"},"inLanguage": ""},{"@type": "WebPage","@id": "https://blog.tatoglu.net/lab/haproxy/ssl-certificate.html/#webpage","url": "https://blog.tatoglu.net/lab/haproxy/ssl-certificate.html","name": "SSL Sertifika - Fatih TatoÄŸlu","isPartOf": {"@id": "https://blog.tatoglu.net/#website"},"datePublished": "2022-06-12T19:03:27+0000","breadcrumb": {"@id": "https://blog.tatoglu.net/lab/haproxy/ssl-certificate.html/#breadcrumb"},"inLanguage": "","potentialAction": [{"@type": "ReadAction","target": ["https://blog.tatoglu.net/lab/haproxy/ssl-certificate.html"]}]},{"@type": "BreadcrumbList","@id": "https://blog.tatoglu.net/lab/haproxy/ssl-certificate.html/#breadcrumb","itemListElement": [{"@type": "ListItem","position": 1,"name": "Ana sayfa","item": "https://blog.tatoglu.net/"},{"@type": "ListItem","position": 2,"name": "SSL Sertifika"}]},{"@type": "Article","@id": "https://blog.tatoglu.net/lab/haproxy/ssl-certificate.html/#article","isPartOf": {"@id": "https://blog.tatoglu.net/lab/haproxy/ssl-certificate.html/#webpage"},"author": {"@id": "https://blog.tatoglu.net//#/schema/person/9112274035621a3fbf80e30c19216034"},"headline": "SSL Sertifika","datePublished": "2022-06-12T19:03:27+0000","mainEntityOfPage": {"@id": "https://blog.tatoglu.net/lab/haproxy/ssl-certificate.html/#webpage"},"publisher": {"@id": "https://blog.tatoglu.net//#/schema/person/9112274035621a3fbf80e30c19216034"},"articleSection": ["lab"],"keywords": ["haproxy","ssl","tls","https","sertifika","pfx","pem"],"inLanguage": ""},{"@type": ["Person"],"@id": "https://blog.tatoglu.net//#/schema/person/9112274035621a3fbf80e30c19216034","name": "Fatih TatoÄŸlu","url": "https://blog.tatoglu.net/about-me.html","image": {"@type": "ImageObject","@id": "https://blog.tatoglu.net/#personlogo","inLanguage": "","url": "https://blog.tatoglu.net/image/about_me.jpg","contentUrl": "https://blog.tatoglu.net/image/about_me.jpg","width": 1024,"height": 683,"caption": "Fatih TatoÄŸlu"},"address": {"@type": "PostalAddress","addressLocality": "Ä°stanbul","addressCountry": "Turkey"},"email": "fatih@tatoglu.net"}]}</script></head><body><header><h1 id="title">SSL Sertifika</h1><summary></summary></header><nav><i class="menu-icon">&#9776;</i><ul><li><a href="https://blog.tatoglu.net/index.html">Anasayfa</a></li><li><a href="https://blog.tatoglu.net/coaching/index.html">KoÃ§luk</a></li><li><a href="https://blog.tatoglu.net/my-notes/index.html">NotlarÄ±m</a></li><li><a href="https://blog.tatoglu.net/lab/index.html">Laboratuvar</a></li><li><a href="https://blog.tatoglu.net/about-me.html">HakkÄ±mda</a></li><li><button id="btnFeedback" class="icon" title="Geri Bildirim">&#128640;</button> <button id="btnDarkTheme" class="icon" title="Koyu Tema">&#127770;</button> <button id="btnLightTheme" class="icon" title="AÃ§Ä±k Tema">&#127774;</button> <button id="btnEnglish" class="icon" title="Ä°ngilizce">ğŸ‡ºğŸ‡¸</button></li></ul></nav><main><section><strong>HAProxy</strong><ul><li><a href=".&#x2F;lab&#x2F;haproxy&#x2F;setup.html">Kurulum</a></li><li><a href=".&#x2F;lab&#x2F;haproxy&#x2F;cluster.html">Cluster</a></li><li><a href=".&#x2F;lab&#x2F;haproxy&#x2F;default-routing.html">Statik YÃ¶nlendirme</a></li><li class="active">SSL Sertifika</li></ul></section><article><p>HAProxy, SSL yapÄ±landÄ±rmasÄ± geÃ§erliyse SSL isteÄŸini iÅŸleyebilir. Genellikle akÄ±ÅŸ, isteÄŸin <code>frontend</code> hizmetini karÅŸÄ±lamasÄ± ve ardÄ±ndan <code>backend</code> hizmetine geÃ§mesi ÅŸeklindedir. SSL/TLS sertifika tanÄ±mÄ± <code>frontend</code> tarafÄ±nda gÃ¶rÃ¼lmektedir. HAProxy&#39;yi yapÄ±landÄ±rmadan Ã¶nce SSL tanÄ±mlama stratejilerinin tÃ¼rlerini kontrol edelim.</p><h2>TLS / SSL Offloading</h2><figure><img src="../image/tls-offloading.png" alt="TLS / SSL Offloading"><figcaption><p>TLS Offloading - <a href="https://www.haproxy.com/documentation/aloha/latest/security/tls/encryption-strategies/" rel="noopener noreferrer" target="_blank">HAProxy Encryption Strategies</a></p></figcaption></figure><p>Bu stratejiyle HAProxy, istemci ile kendisi arasÄ±ndaki mesajlarÄ± ÅŸifreler, ancak kendisi ile arka uÃ§ sunucularÄ± arasÄ±ndaki iletiÅŸim ÅŸifrelenmez. SSL/TLS sertifikasÄ± HAProxy sunucularÄ±nda saklanÄ±r.</p><h2>TLS / SSL Passthrough</h2><figure><img src="../image/tls-passthrough.png" alt="TLS / SSL Passthrough"><figcaption><p>TLS Passthrough - <a href="https://www.haproxy.com/documentation/aloha/latest/security/tls/encryption-strategies/" rel="noopener noreferrer" target="_blank">HAProxy Encryption Strategies</a></p></figcaption></figure><p>Bu stratejiyle HAProxy, ÅŸifreleme veya ÅŸifre Ã§Ã¶zme iÅŸlemini uygulamaz. Bu iÅŸlemden backend sunucularÄ± sorumludur. Ä°stek, doÄŸru yÃ¶nlendirme kuralÄ±yla eÅŸleÅŸtirildikten sonra herhangi bir iÅŸlem yapÄ±lmadan yalnÄ±zca backend sunucusuna iletilir.</p><h2>TLS / SSL Bridging</h2><figure><img src="../image/tls-bridging.png" alt="TLS / SSL Bridging"><figcaption><p>TLS Bridging - <a href="https://www.haproxy.com/documentation/aloha/latest/security/tls/encryption-strategies/" rel="noopener noreferrer" target="_blank">HAProxy Encryption Strategies</a></p></figcaption></figure><p>Bu stratejiyle HAProxy tÃ¼m mesajlarÄ± ÅŸifreler. Ä°stek HAProxy&#39;ye ulaÅŸÄ±r ve HAProxy, header doÄŸrulama gibi bazÄ± iÅŸlemler iÃ§in isteÄŸin ÅŸifresini Ã§Ã¶zer. Daha sonra istek, backend sunuculara iletilmek Ã¼zere HAProxy tarafÄ±ndan ÅŸifrelenir. SSL/TLS sertifikasÄ± her iki tarafta da, HAProxy ve backend sunucularda tutulmalÄ±dÄ±r.</p><h2>KonfigÃ¼rasyon</h2><pre><code class="language-shell">devops@haproxy-01:~$ sudo vi /etc/haproxy/haproxy.conf
</code></pre><pre><code class="language-nestedtext">...
##################################################
#                    Frontend                    #
##################################################
frontend https_in
    mode http
    bind *:443 ssl crt /etc/haproxy/certificates/certificate-cert-key.pem

    ...

    default_backend be_default
##################################################


##################################################
#                    Backend                     #
##################################################
backend be_default
    mode http

    errorfile 503 /etc/haproxy/errors/503.http
##################################################
...
</code></pre><p>YukarÄ±daki yapÄ±landÄ±rmayla HAProxy, SSL / TLS isteklerini iÅŸleyebilir ve bunlarÄ± &quot;arka uÃ§&quot; sunucularÄ±na iletebilir. YapÄ±landÄ±rmayÄ± doÄŸrulamadan Ã¶nce SSL/TLS sertifikasÄ±nÄ±n belirtilen konumda PEM formatÄ±nda bulunmasÄ± gerekir. HAProxy, PEM dosyasÄ±nÄ±n genel ve Ã¶zel anahtarÄ± sÄ±rayla iÃ§ermesini ister. Bu iÅŸlem iÃ§in aÅŸaÄŸÄ±daki komutlar faydalÄ± olabilir.</p><pre><code class="language-shell">devops@haproxy-01:~$ sudo su
root@haproxy-01:/home/devops# openssl pkcs12 -in certificate.pfx -nocerts -out certificate_priv.pem -nodes
root@haproxy-01:/home/devops# openssl pkcs12 -in certificate.pfx -nokeys -out certificate_public.pem -nodes
root@haproxy-01:/home/devops# cat certificate_public.pem certificate_priv.pem &gt; certificate-cert-key.pem
root@haproxy-01:/home/devops# mv certificate-cert-key.pem /etc/haproxy/certificates/certificate-cert-key.pem
</code></pre><p>Komut, Ã¶nce Ã¶zel ve genel anahtarlarÄ± pfx dosyasÄ±ndan Ã§Ä±karÄ±r. Ã–zel ve genel anahtarlarÄ±nÄ±z ayrÄ± ayrÄ± varsa aÅŸaÄŸÄ±daki talimatlarÄ± kullanabilirsiniz.</p><pre><code class="language-shell">devops@haproxy-01:~$ sudo su
root@haproxy-01:/home/devops# cat certificate_public.pem certificate_priv.pem &gt; certificate-cert-key.pem
root@haproxy-01:/home/devops# mv certificate-cert-key.pem /etc/haproxy/certificates/certificate-cert-key.pem
</code></pre><p>Bu deÄŸiÅŸikliÄŸi uygulamadan Ã¶nce yapÄ±landÄ±rma dosyasÄ±nÄ±n doÄŸrulanmasÄ± gerekir.</p><pre><code class="language-shell">devops@haproxy-01:~$ sudo /opt/haproxy/sbin/haproxy -c -V -f /etc/haproxy/haproxy.conf
devops@haproxy-01:~$ sudo systemctl reload haproxy
</code></pre><p>Cluster ortamÄ± var ise konfigÃ¼rasyonun tÃ¼m sunuculara uygulanmasÄ± gerekmektedir.</p></article></main><footer>&copy; 1985 - <a href="about-me.html" rel="noopener noreferrer" target="_blank">Fatih TatoÄŸlu</a></footer><script src="https://blog.tatoglu.net/js/main.js?v=96a6c3c79b3d35ef37896ed4f9a413ce"></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-GSVKFRLFNV&v=96a6c3c79b3d35ef37896ed4f9a413ce"></script><script src="https://blog.tatoglu.net/js/analytics.js?v=96a6c3c79b3d35ef37896ed4f9a413ce"></script><div id="pnlFeedbackSurvey"><div class="model-content"><button id="btnFeedbackSurveyClose" class="icon bold x-small">&times;</button><iframe src="https://docs.google.com/forms/d/e/1FAIpQLSewJ_x10HBlFs2lO2zHUBI3ZeSdEXaISpK292RPJBoZyeC1HA/viewform?embedded=true" frameborder="0" marginheight="0" marginwidth="0">Loadingâ€¦</iframe></div></div></body></html>